<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VÃ²ng Quay May Máº¯n</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        background: radial-gradient(circle, #ffecb3, #ffc107);
        margin: 0;
        padding: 0;
      }

      h1 {
        color: #000000;
        text-shadow: 2px 2px 4px #000;
        margin-top: 20px;
      }

      canvas {
        display: block;
        margin: 20px auto;
        border: 5px solid #ff5722;
        border-radius: 50%;
      }

      #spinButton {
        display: block;
        margin: 20px auto;
        padding: 15px 25px;
        font-size: 20px;
        font-weight: bold;
        background-color: #00ff08;
        color: rgb(255, 255, 255);
        border: none;
        border-radius: 5px;
        cursor: pointer;
        box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.3);
      }

      #spinButton:disabled {
        background-color: #ff0000;
        cursor: not-allowed;
      }

      #result {
        text-align: center;
        font-size: 18px;
        font-weight: bold;
        color: #000; /* Chá»¯ Ä‘en */
        margin-top: 20px;
        padding: 15px;
        background: #73ff00;
        border: 2px solid #000;
        border-radius: 10px;
        max-width: 80%;
        margin: 20px auto;
        word-wrap: break-word;
        box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.3);
      }
    </style>
  </head>
  <body>
    <h1>ğŸ¡ VÃ²ng Quay May Máº¯n ğŸ¡</h1>
    <canvas id="wheelCanvas" width="400" height="400"></canvas>
    <button id="spinButton">Quay</button>
    <div id="result"></div>
    <div id="prizesList">
      <h2>ğŸ Danh sÃ¡ch pháº§n thÆ°á»Ÿng ğŸ</h2>
      <ul>
        <li>2 Giáº£i Ä‘áº·c biá»‡t: Xe Ã´ tÃ´ trÃªn 50K $ ğŸš—</li>
        <li>15 Giáº£i nháº¥t: iPhone 16 Pro Max ğŸ“±</li>
        <li>30 Giáº£i nhÃ¬: LT ASUS Vivobook 14 ğŸ’»</li>
        <li>50 Giáº£i ba: MÃ¡y Ä‘iá»u hÃ²a â„ï¸</li>
        <li>TrÃºng tiá»n: 100 sao ğŸŒŸ</li>
        <li>TrÃºng tiá»n: 50 sao ğŸŒŸ</li>
        <li>TrÃºng tiá»n: 20 sao ğŸŒŸ</li>
        <li>TrÃºng thÆ°á»Ÿng: 3 ngÃ y Dá»‹ch Vá»¥ VIP ğŸ’¼</li>
        <li>TrÃºng thÆ°á»Ÿng: 1short/60 phÃºt â±ï¸</li>
        <li>TrÃºng thÆ°á»Ÿng: 1short/24 tiáº¿ng â±ï¸</li>
        <li>ThÃªm lÆ°á»£t quay: 1 vÃ²ng ğŸ”„</li>
        <li>ChÃºc báº¡n may máº¯n ğŸ€</li>
      </ul>
    </div>
    <script>
      // HÃ m táº¡o UUID
      function generateUUID() {
        return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(
          /[xy]/g,
          function (c) {
            const r = (Math.random() * 16) | 0;
            const v = c === "x" ? r : (r & 0x3) | 0x8;
            return v.toString(16);
          }
        );
      }

      // Kiá»ƒm tra hoáº·c táº¡o ID duy nháº¥t
      function getOrCreateBrowserID() {
        let browserID = localStorage.getItem("browserID");
        if (!browserID) {
          browserID = generateUUID();
          localStorage.setItem("browserID", browserID);
        }
        return browserID;
      }

      const browserID = getOrCreateBrowserID();
      const spinData = JSON.parse(localStorage.getItem("spinData")) || {};
      const hasSpun = !!spinData[browserID];

      const prizes = [
        { name: "Xe Ã´ tÃ´ trÃªn 50K $ ğŸš—", chance: 2 },
        { name: "iPhone 16 Pro Max ğŸ“±", chance: 15 },
        { name: "LT ASUS VV14 ğŸ’»", chance: 30 },
        { name: "MÃ¡y Ä‘iá»u hÃ²a â„ï¸", chance: 50 },
        { name: "100 sao ğŸŒŸ", chance: 100 },
        { name: "50 sao ğŸŒŸ", chance: 200 },
        { name: "20 sao ğŸŒŸ", chance: 300 },
        { name: "3 ngÃ y DVá»¥ VIP ğŸ’¼", chance: 10 },
        { name: "1short/60 phÃºt â±ï¸", chance: 20 },
        { name: "1short/24 tiáº¿ng â±ï¸", chance: 5 },
        { name: "1 vÃ²ng quay ğŸ”„", chance: 10 },
        { name: "ChÃºc báº¡n may máº¯nğŸ€", chance: 500 },
      ];

      const colors = [
        "#f44336",
        "#4caf50",
        "#2196f3",
        "#ffeb3b",
        "#9c27b0",
        "#ff9800",
        "#795548",
      ];
      const canvas = document.getElementById("wheelCanvas");
      const ctx = canvas.getContext("2d");
      const radius = canvas.width / 2;
      const spinButton = document.getElementById("spinButton");
      const resultDiv = document.getElementById("result");

      if (hasSpun) {
        spinButton.disabled = true;
        resultDiv.textContent = "Báº¡n Ä‘Ã£ quay rá»“i! HÃ£y thá»­ láº¡i láº§n sau.";
      }

      function drawWheel() {
        const anglePerSegment = (2 * Math.PI) / prizes.length;
        for (let i = 0; i < prizes.length; i++) {
          ctx.beginPath();
          ctx.moveTo(radius, radius);
          ctx.arc(
            radius,
            radius,
            radius,
            i * anglePerSegment,
            (i + 1) * anglePerSegment
          );
          ctx.fillStyle = `hsl(${(i * 360) / prizes.length}, 80%, 70%)`;
          ctx.fill();
          ctx.closePath();

          ctx.save();
          ctx.translate(radius, radius);
          ctx.rotate((i + 0.5) * anglePerSegment);
          ctx.textAlign = "right";
          ctx.fillStyle = "#000";
          ctx.font = "bold 14px Arial";
          ctx.fillText(prizes[i].name, radius - 20, 10);
          ctx.restore();
        }
      }

      function spinWheel() {
        if (hasSpun) return;
        spinButton.disabled = true;
        resultDiv.textContent = "Äang quay...";

        const totalChance = prizes.reduce(
          (sum, prize) => sum + prize.chance,
          0
        );
        const randomNum = Math.random() * totalChance;
        let cumulativeChance = 0;
        let selectedPrize = null;

        for (let prize of prizes) {
          cumulativeChance += prize.chance;
          if (randomNum <= cumulativeChance) {
            selectedPrize = prize;
            break;
          }
        }

        const spinAngle = Math.random() * 360 + 360 * 5;
        let currentAngle = 0;
        const spinInterval = setInterval(() => {
          currentAngle += 10;
          canvas.style.transform = `rotate(${currentAngle}deg)`;
          if (currentAngle >= spinAngle) {
            clearInterval(spinInterval);
            resultDiv.textContent = `ğŸ‰ ChÃºc má»«ng! Báº¡n Ä‘Ã£ trÃºng: ${selectedPrize.name}`;
            spinData[browserID] = true;
            localStorage.setItem("spinData", JSON.stringify(spinData));
          }
        }, 20);
      }

      spinButton.addEventListener("click", spinWheel);
      drawWheel();
    </script>
  </body>
</html>
